[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Robin Penfold",
    "section": "",
    "text": "Projecting portfolio risk\n\n\n\n\n\nRisk analysis is a standard technique within quantitative investment. In this post, I’ll describe how to perform it succinctly in R.\n\n\n\n\n\nMay 20, 2023\n\n\n\n\n\n\n\n\n\n\n\n\nWinning at Wordle\n\n\n\n\n\nWordle is a source of healthy competition in our family. So, with a long train journey ahead of me, I thought I would embrace my nerd power and gain a competitive edge over my wife! I downloaded the most common five-letter words from the internet and analysed them with the following code. This leads me to suggest — only in the context of Wordle — that you should STARE at the CHILD that is FUNKY. \n\n\n\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\nPremPredict\n\n\n\n\n\nThey think it’s all over. It is now.\n\n\n\n\n\nSep 19, 2020\n\n\n\n\n\n\n\n\n\n\n\n\nAsset manager evaluation\n\n\n\n\n\nBack in the day, I wrote research papers about investment practice. One example concerned how asset owners could better evaluate the investment performance of their asset managers. Basically, the idea is to view performance in the way that a Bayesian would. \n\n\n\n\n\nOct 20, 2016\n\n\n\n\n\n\n\n\n\n\n\n\nBrexit vote analysis\n\n\n\n\n\nI wanted more insight into the recent vote and so investigated each constituency, comparing the Brexit vote with that of the winning parliamentary party from 2016 \n\n\n\n\n\nOct 12, 2016\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/evaluation/index.html",
    "href": "posts/evaluation/index.html",
    "title": "Asset manager evaluation",
    "section": "",
    "text": "The idea is pretty simple, which I’ll outline below. (I can do so, as the materials are already in the public domain.)\nIf you want the details, check out the formal paper at SSRN. For a more accessible introduction, I’d recommend the video below that was taken (and won an award) at the International Congress of Actuaries in 2014.\n\n\n\nThe gist of the idea\nIn short, a key mantra of investment advisors is that asset owners should ignore the performance of their asset manager. Whether the manager has outperformed for you or not, it is claimed, is irrelevant to how you should expect them to perform in the future. However, a key idea in statistics, called Bayesian thinking, suggests the opposite: that you should use any new information you get about something to update your thinking on it.\nIn this work, I therefore used Bayesian thinking to understand the advice that asset owners should get. It turns out that this advice makes common sense, particularly when paired with an understanding of whether the asset manager has some longer-term cyclicality in their performance.\nHere’s that video that I mentioned:"
  },
  {
    "objectID": "posts/portfolioRisk/index.html",
    "href": "posts/portfolioRisk/index.html",
    "title": "Projecting portfolio risk",
    "section": "",
    "text": "To do so, I’ll deliberately pick a minimal example and assume that our portfolio has the thirty-stock Dow-Jones Industrial Average (DJIA) as its index.\nI’ll show the results in a couple of paragraphs. Before that, let’s consider a little of the theory behind this analysis. Specifically, that the active variance of a portfolio relative to its index is: \\[\\omega^2 = X^T V X\\]\n, where:\nGiven this equation, I see that I need to begin the analysis by downloading the holdings of the index and the pricing data for the constituent stocks.\nlibrary(tidyquant)\nlibrary(tidyverse)\nlibrary(tsibble)\nlibrary(waldo)\n\n# weights_index &lt;- tq_index(\"DOW\")\n# write_rds(x = weights_index, file = \"weights_index.rds\")\n\n# stock_prices  &lt;- tq_get(\n#   x = weights_index |&gt; pull(symbol), \n#   get = \"stock.prices\", \n#   from = \"2022-01-01\")\n# write_rds(x = stock_prices, file = \"stock_prices.rds\", compress = \"xz\")"
  },
  {
    "objectID": "posts/portfolioRisk/index.html#footnotes",
    "href": "posts/portfolioRisk/index.html#footnotes",
    "title": "Projecting portfolio risk",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nFor the sake of simplicity, I only consider split-adjusted price returns rather than the equivalent total returns in this example↩︎\nThis might be a heroic assumption, as it implies an independence between the risks experienced in different months↩︎\nNote that the sum of these values will add to the total active variance, as this calculation is essentially vector multiplication.↩︎"
  },
  {
    "objectID": "posts/brexit/index.html",
    "href": "posts/brexit/index.html",
    "title": "Brexit vote analysis",
    "section": "",
    "text": "You can scroll down for an interactive chart of each constituency, but the following chart shows the main detail.\n\n\n&lt;/&gt;\nlibrary(dplyr)\nlibrary(forcats)\nlibrary(ggiraph)\nlibrary(glue)\nlibrary(ggplot2)\nlibrary(ggtext)\nlibrary(parlitools)\nlibrary(scales)\n\nmap_details &lt;- west_hex_map\nsf::st_crs(map_details) = 4326\n\ndata_brexit &lt;- leave_votes_west |&gt;  \n  rename(`Leave Vote` = figure_to_use) |&gt; \n  mutate(\n    `Party of MP` = as_factor(party_2016), \n    `Party of MP` = \n      recode(\n        `Party of MP`,\n        `Scottish National Party` = \"SNP\", \n        `Liberal Democrat` = \"LibDem\"\n        ),\n    `Party of MP` = fct_lump(\n      `Party of MP`,\n      n = 5, \n      other_level = \"Other\"\n      )\n    ) |&gt; \n  left_join(\n    map_details,\n    by = c(\"ons_const_id\" = \"gss_code\")\n    ) |&gt; \n  mutate(\n    constituency = if_else(\n      is.na(constituency_name.x), \n      constituency_name.y, \n      constituency_name.x\n      ),\n    vote_status = case_when(\n      (`Leave Vote` &gt;= 0) & (`Leave Vote` &lt;= 0.4) ~ \"Remain\",\n      (`Leave Vote` &gt; 0.4) & (`Leave Vote` &lt;= 0.6) ~ \"Close Call\",\n      (`Leave Vote` &gt; 0.6) & (`Leave Vote` &lt;= 1) ~ \"Leave\",\n      TRUE ~ \"Error\"\n      ),\n    vote_status = as_factor(vote_status),\n    vote_status = fct_relevel(vote_status, sort)\n    ) |&gt; \n  select(constituency, `Leave Vote`, `Party of MP`, ons_const_id, vote_status, geometry)\n\nhtml_text &lt;- glue(\"&lt;span&gt;Showing constituencies with &lt;span style='color:#0087DC;'&gt;Conservative&lt;/span&gt;, &lt;span style='color:#DC241F;'&gt;Labour&lt;/span&gt;, &lt;span style='color:#FFFF00;'&gt;SNP&lt;/span&gt;, &lt;span style='color:#FDBB30;'&gt;LibDem&lt;/span&gt; and &lt;span style='color:#AFAFAFAF;'&gt;Other&lt;/span&gt; MPs&lt;/span&gt;&lt;br/&gt;\")\n\ndata_brexit |&gt; \n  ggplot() + \n  geom_sf(\n    aes(\n      group = constituency,\n      geometry = geometry,\n      fill = `Party of MP`\n      ),\n    size = 0.1\n    ) + \n  scale_fill_manual(\n    values = c(\n      Conservative = \"#0087DC\",\n      Labour = \"#DC241F\",\n      SNP = \"#FFFF00\",\n      LibDem = \"#FDBB30\",\n      Other = \"grey80\"\n      )\n    ) + \n  facet_grid(~vote_status, margins = TRUE, drop = TRUE) +\n  theme_void() + \n  labs(\n    title = \"Leave voters seem to have a bigger split in party allegiance\",\n    subtitle = html_text\n  ) + \n  theme(\n    plot.title.position = \"plot\",\n    plot.subtitle = element_markdown(),\n    legend.position = \"none\",\n    plot.background = element_rect(\n      fill = \"grey90\", \n      colour = \"grey90\", \n      linewidth = 1\n      ),\n    plot.margin = margin(0.5, 0.5, 0.5, 0.5, \"cm\")\n    )\n\n\n\n\n\n\n\n\n\nBasically, outside of Scotland, there seems to be a bigger split in Leaver constituencies than in their Remainer counterparts.\nTo get the details for each constituency, hover over the relevant spot in the chart below.\n\n\n&lt;/&gt;\ngg &lt;- data_brexit |&gt; \n  ggplot() + \n  geom_sf_interactive(\n    aes(\n      group = constituency,\n      geometry = geometry,\n      fill = `Leave Vote`,\n      colour = `Party of MP`,\n      tooltip = paste0(\n        constituency, \n        \"\\n MP: \",\n        `Party of MP`,\n        \"\\n Leave vote: \",\n        round(`Leave Vote` * 100, 0),\n        \"%\"\n        )\n    ),\n    size = 0.1\n  ) + \n  scale_fill_gradient_interactive(\n    low = \"white\", \n    high = \"#63666a\",\n    labels = percent_format(accuracy = 1)\n    ) +\n  scale_colour_manual_interactive(\n    values = c(\n      Conservative = \"#0087DC\",\n      Labour = \"#DC241F\",\n      SNP = \"#FFFF00\",\n      LibDem = \"#FDBB30\",\n      Other = \"grey80\"\n      )\n    ) + \n  theme_void() +\n  labs(\n    title = \"Leave vote and winning party, by constituency\", \n    subtitle = \"Hover over a point for the details\"\n  ) + \n  theme(\n    legend.position = \"right\",\n    legend.text = element_text(size = 6, hjust = 0),\n    legend.title = element_text(size = 8)\n    )\n\ngirafe(ggobj = gg)"
  },
  {
    "objectID": "posts/wordle/index.html",
    "href": "posts/wordle/index.html",
    "title": "Winning at Wordle",
    "section": "",
    "text": "Let’s start by getting the ~500 most commonly-occurring five-letter words (that I downloaded as a csv file from the internet).\n\nsuppressPackageStartupMessages(library(tidyverse))\n\nwords &lt;- \n  read_csv(\n    file = \"five-letters.csv\", \n    col_names = FALSE\n    ) |&gt; \n  rename(\"word\" = X1) |&gt; \n  mutate(word = str_to_lower(word)) |&gt; \n  mutate(\n    l1 = str_sub(string = word, start = 1, end = 1),\n    l2 = str_sub(string = word, start = 2, end = 2),\n    l3 = str_sub(string = word, start = 3, end = 3),\n    l4 = str_sub(string = word, start = 4, end = 4),\n    l5 = str_sub(string = word, start = 5, end = 5)\n  )\n\nwords\n\n\n  \n\n\n\nFor reference, I’ll also chart the popularity of each letter by their order in these five-letter words.\n\nwords_long &lt;- words |&gt; \n  pivot_longer(\n    cols = -word, \n    names_to = \"measure\", \n    values_to = \"values\"\n    ) |&gt; \n  mutate(\n    position = as.integer(\n      str_sub(string = measure, start = 2)\n      )\n    ) |&gt; \n  select(values, position)\n\nwords_long |&gt; \n  count(values, position) |&gt; \n  mutate(\n    position = case_match(\n      position,\n      1 ~ \"1st\",\n      2 ~ \"2nd\",\n      3 ~ \"3rd\",\n      4 ~ \"4th\",\n      5 ~ \"5th\"\n      )\n    ) |&gt; \n  ggplot(\n    aes(\n      x = values, \n      y = n, \n      fill = values %in% c(\"a\", \"e\", \"r\", \"s\", \"t\")\n      )\n    ) + \n  geom_col() + \n  scale_y_continuous(\n    limits = c(0, NA), \n    minor_breaks = NULL, \n    expand = expansion(mult = 0, add = 1)\n    ) + \n  scale_fill_manual(values = c(\"#edd9c0\", \"#63431c\")) +\n  facet_wrap(~position, nrow = 1) + \n  theme_minimal() + \n  labs(\n    title = \"Frequency of letter by word order\",\n    subtitle = \"Emphasis on the letters a, e, r, s and t\\n\",\n    x = NULL,\n    y = NULL\n  ) +\n  theme(\n    legend.position = \"none\",\n    plot.title.position = \"plot\"\n    )\n\n\n\n\n\n\n\n\nAs you can see from the emphasis, some of these letters appear a lot more than others, and especially at the start and end of the word."
  },
  {
    "objectID": "posts/wordle/index.html#footnotes",
    "href": "posts/wordle/index.html#footnotes",
    "title": "Winning at Wordle",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThese ‘best’ guesses might not be perfect, as my assumptions above and the approach in general could probably be improved, perhaps with Operational Research techniques. That said, I suspect that ‘stare’ and the next guesses are decent approximations to the ideal solution.↩︎"
  },
  {
    "objectID": "posts/prempredict/index.html",
    "href": "posts/prempredict/index.html",
    "title": "PremPredict",
    "section": "",
    "text": "After a good run of thirteen years, now feels like the right time to end our PremPredict competition.\nThanks to all of you who have shared in the fun over this time. I’m pleased to say that this included Les Penfold, Mike Finnis and Roger Gathercole.\nAs you’ll see below, though, this post and the Wall of Fame will remain here, always showing that Peter Finnis was left holding the crown!\n(Oh yeah – and always showing how some of the biggest football nerds remained winless.)\n\n\n\nPremPredict champions\n\n2007/08 – Robert Wye\n2008/09 – Les Penfold\n2009/10 – Beth Penfold\n2010/11 – George Quin and Miranda Stride\n2011/12 – Hannah Finnis\n2012/13 – Michael Cheeseman\n2013/14 – Danny Russell\n2014/15 – Mathew Saunders\n2015/16 – Roger Gathercole\n2016/17 – Luke Finnis\n2017/18 – George Quin\n2018/19 – Roger Gathercole\n2019/20 – Peter Finnis\n\n\nThanks again for all the fun!"
  }
]